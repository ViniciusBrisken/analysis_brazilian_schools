ggarrange(chart_mean_medio, chart_mean_infantil, chart_mean_fundamental,
ncol = 1, nrow = 3)
chart_media_all
##### Means all ########
# calculate mean by Regiao
df_mean_all <- ddply(dfMedias, .(Regiao), summarize,  fundamental=mean(Total_fundamental),
medio=mean(Total_medio), Mnfantil=mean(Total_infantil))
# ignore values that don't have Regiao
df_mean_all <- df_mean_all[df_mean_all$Regiao != '',]
df_mean_all <- melt(df_mean_all, id = c("Regiao"))
# Bar chart ALL
chart_media_all <- ggplot(df_mean_all, aes(x = df_mean_all$Regiao, y = df_mean_all$value, fill = factor(df_mean_all$variable))) +
geom_bar(stat = "identity", position=position_dodge()) +
labs(fill = "Ensino") +
xlab("Regiões do Brasil") + ylab("Média") +
ggtitle("Média de notas no ensino médio no Brasil")
chart_media_all
##### Means all ########
# calculate mean by Regiao
df_mean_all <- ddply(dfMedias, .(Regiao), summarize,  fundamental=mean(Total_fundamental),
medio=mean(Total_medio), infantil=mean(Total_infantil))
# ignore values that don't have Regiao
df_mean_all <- df_mean_all[df_mean_all$Regiao != '',]
df_mean_all <- melt(df_mean_all, id = c("Regiao"))
ggarrange(chart_mean_medio, chart_mean_infantil, chart_mean_fundamental,
ncol = 1, nrow = 3)
chart_media_all
ggarrange(chart_mean_medio, chart_mean_infantil, chart_mean_fundamental,
ncol = 1, nrow = 3)
chart_media_all
# Bar chart ALL
chart_media_all <- ggplot(df_mean_all, aes(x = df_mean_all$Regiao, y = df_mean_all$value, fill = factor(df_mean_all$variable))) +
geom_bar(stat = "identity", position=position_dodge()) +
labs(fill = "Ensino") +
xlab("Regiões do Brasil") + ylab("Média") +
ggtitle("Média de notas no ensino fundamental x médio x infantil no Brasil")
chart_media_all
ggarrange(chart_mean_medio, chart_mean_infantil, chart_mean_fundamental,
ncol = 1, nrow = 3)
chart_media_all
ggarrange(chart_mean_medio, chart_mean_infantil, chart_mean_fundamental,
ncol = 2, nrow = 2)
ggarrange(chart_mean_medio, chart_mean_infantil, chart_mean_fundamental,
ncol = 3, nrow = 1)
ggarrange(chart_mean_medio, chart_mean_infantil, chart_mean_fundamental,
ncol = 2, nrow = 2)
chart_media_all
ggarrange(chart_mean_medio, chart_mean_infantil, chart_mean_fundamental,
ncol = 2, nrow = 2)
chart_media_all
# Bar chart ALL
chart_media_all <- ggplot(df_mean_all, aes(x = df_mean_all$Regiao, y = df_mean_all$value, fill = factor(df_mean_all$variable))) +
geom_bar(stat = "identity", position=position_dodge()) +
labs(fill = "Ensino") +
xlab("Regiões do Brasil") + ylab("Média") +
ggtitle("Média de alunos por turma no ensino fundamental x médio x infantil no Brasil")
chart_media_all
# Bar chart ALL
chart_media_all <- ggplot(df_mean_all, aes(x = df_mean_all$Regiao, y = df_mean_all$value, fill = factor(df_mean_all$variable))) +
geom_bar(stat = "identity", position=position_dodge()) +
labs(fill = "Ensino") +
xlab("Regiões do Brasil") + ylab("Média de alunos") +
ggtitle("Média de alunos por turma no ensino fundamental x médio x infantil no Brasil")
chart_media_all
colnames(dfMedias)
apply(dfMedias[, c(8, 10, 23)], 1, sum)
ddply(dfMedias, .(ano), summarize,  fundamental=sum(Total_fundamental),
medio=sum(Total_medio), infantil=sum(Total_infantil))
ddply(dfMedias, .(Ano), summarize,  fundamental=sum(Total_fundamental),
medio=sum(Total_medio), infantil=sum(Total_infantil))
df_numero_alunos <- ddply(dfMedias, .(Ano), summarize,  fundamental=sum(Total_fundamental),
medio=sum(Total_medio), infantil=sum(Total_infantil))
df_numero_alunos
df_numero_alunos
df_numero_alunos <- df_numero_alunos[is.numeric(df_numero_alunos$Ano)]
df_numero_alunos
df_numero_alunos <- ddply(dfMedias, .(Ano), summarize,  fundamental=sum(Total_fundamental),
medio=sum(Total_medio), infantil=sum(Total_infantil))
df_numero_alunos$Ano
class(df_numero_alunos$Ano)
as.numeric(df_numero_alunos$Ano)
df_numero_alunos <- df_numero_alunos[(df_numero_alunos$Ano == '2010')]
df_numero_alunos
df_numero_alunos <- ddply(dfMedias, .(Ano), summarize,  fundamental=sum(Total_fundamental),
medio=sum(Total_medio), infantil=sum(Total_infantil))
df_numero_alunos <- df_numero_alunos[(df_numero_alunos$Ano == '2010')]
df_numero_alunos
df_numero_alunos <- ddply(dfMedias, .(Ano), summarize,  fundamental=sum(Total_fundamental),
medio=sum(Total_medio), infantil=sum(Total_infantil))
df_numero_alunos
df_numero_alunos <- df_numero_alunos[(df_numero_alunos$Ano == '2010'),]
df_numero_alunos
melt(df_numero_alunos, id = c("Ano"))
df_numero_alunos
(df_numero_alunos$fundamental/df_numero_alunos$infantil) *100
df_numero_alunos$desistentes_fundamental <- (df_numero_alunos$fundamental/df_numero_alunos$infantil) *100
(df_numero_alunos$medio/df_numero_alunos$fundamental) *100
df_numero_alunos$desistentes_medio <- (df_numero_alunos$medio/df_numero_alunos$fundamental) *100
df_numero_alunos <- melt(df_numero_alunos, id = c("Ano"))
df_numero_alunos
df_numero_alunos <- df_numero_alunos[(df_numero_alunos$Ano == '2010'),]
df_numero_alunos
df_numero_alunos$desistentes_fundamental <- (df_numero_alunos$fundamental/df_numero_alunos$infantil) *100
df_numero_alunos$desistentes_medio <- (df_numero_alunos$medio/df_numero_alunos$fundamental) *100
df_numero_alunos <- ddply(dfMedias, .(Ano), summarize,  fundamental=sum(Total_fundamental),
medio=sum(Total_medio), infantil=sum(Total_infantil))
df_numero_alunos <- df_numero_alunos[(df_numero_alunos$Ano == '2010'),]
df_numero_alunos
df_numero_alunos$desistentes_fundamental <- (df_numero_alunos$fundamental/df_numero_alunos$infantil) *100
df_numero_alunos$desistentes_medio <- (df_numero_alunos$medio/df_numero_alunos$fundamental) *100
df_numero_alunos
subset(df_numero_alunos, select = c('Ano', 'desistentes_fundamental', 'desistentes_medio'))
df_numero_alunos <- subset(df_numero_alunos, select = c('Ano', 'desistentes_fundamental', 'desistentes_medio'))
melt(df_numero_alunos, id = c("Ano"))
df_numero_alunos$desistentes_fundamental <- ((df_numero_alunos$fundamental/df_numero_alunos$infantil) *100) -100
df_numero_alunos <- ddply(dfMedias, .(Ano), summarize,  fundamental=sum(Total_fundamental),
medio=sum(Total_medio), infantil=sum(Total_infantil))
df_numero_alunos <- df_numero_alunos[(df_numero_alunos$Ano == '2010'),]
df_numero_alunos
df_numero_alunos$desistentes_fundamental <- ((df_numero_alunos$fundamental/df_numero_alunos$infantil) *100) -100
df_numero_alunos$desistentes_medio <- ((df_numero_alunos$medio/df_numero_alunos$fundamental) *100) -100
df_numero_alunos <- subset(df_numero_alunos, select = c('Ano', 'desistentes_fundamental', 'desistentes_medio'))
df_numero_alunos <- melt(df_numero_alunos, id = c("Ano"))
df_numero_alunos
df_numero_alunos <- ddply(dfMedias, .(Ano), summarize,  fundamental=sum(Total_fundamental),
medio=sum(Total_medio), infantil=sum(Total_infantil))
df_numero_alunos <- df_numero_alunos[(df_numero_alunos$Ano == '2010'),]
df_numero_alunos
df_numero_alunos$desistentes_fundamental <- ((df_numero_alunos$fundamental/df_numero_alunos$infantil) *100) -100 * -1
df_numero_alunos$desistentes_medio <- ((df_numero_alunos$medio/df_numero_alunos$fundamental) *100) -100 * -1
df_numero_alunos <- subset(df_numero_alunos, select = c('Ano', 'desistentes_fundamental', 'desistentes_medio'))
df_numero_alunos <- melt(df_numero_alunos, id = c("Ano"))
df_numero_alunos
df_numero_alunos <- ddply(dfMedias, .(Ano), summarize,  fundamental=sum(Total_fundamental),
medio=sum(Total_medio), infantil=sum(Total_infantil))
df_numero_alunos <- df_numero_alunos[(df_numero_alunos$Ano == '2010'),]
df_numero_alunos
df_numero_alunos$desistentes_fundamental <- ((df_numero_alunos$fundamental/df_numero_alunos$infantil) *100) -100
df_numero_alunos$desistentes_medio <- ((df_numero_alunos$medio/df_numero_alunos$fundamental) *100) -100
df_numero_alunos <- subset(df_numero_alunos, select = c('Ano', 'desistentes_fundamental', 'desistentes_medio'))
df_numero_alunos <- melt(df_numero_alunos, id = c("Ano"))
df_numero_alunos
df_numero_alunos <- ddply(dfMedias, .(Ano), summarize,  fundamental=sum(Total_fundamental),
medio=sum(Total_medio), infantil=sum(Total_infantil))
df_numero_alunos <- df_numero_alunos[(df_numero_alunos$Ano == '2010'),]
df_numero_alunos
(((df_numero_alunos$fundamental/df_numero_alunos$infantil) *100) - 100) * -1
df_numero_alunos$desistentes_fundamental <- (((df_numero_alunos$fundamental/df_numero_alunos$infantil) *100) - 100) * -1
df_numero_alunos$desistentes_medio <- (((df_numero_alunos$medio/df_numero_alunos$fundamental) *100) - 100) * -1
(df_numero_alunos$desistentes_fundamental + df_numero_alunos$desistentes_medio) - 100
((df_numero_alunos$desistentes_fundamental + df_numero_alunos$desistentes_medio) - 100) * -1
df_numero_alunos <- subset(df_numero_alunos, select = c('Ano', 'desistentes_fundamental', 'desistentes_medio', 'chegam_ensino_medio'))
df_numero_alunos <- melt(df_numero_alunos, id = c("Ano"))
df_numero_alunos <- ddply(dfMedias, .(Ano), summarize,  fundamental=sum(Total_fundamental),
medio=sum(Total_medio), infantil=sum(Total_infantil))
df_numero_alunos <- df_numero_alunos[(df_numero_alunos$Ano == '2010'),]
df_numero_alunos
df_numero_alunos$desistentes_fundamental <- (((df_numero_alunos$fundamental/df_numero_alunos$infantil) *100) - 100) * -1
df_numero_alunos$desistentes_medio <- (((df_numero_alunos$medio/df_numero_alunos$fundamental) *100) - 100) * -1
df_numero_alunos$chegam_ensino_medio <- ((df_numero_alunos$desistentes_fundamental + df_numero_alunos$desistentes_medio) - 100) * -1
df_numero_alunos <- subset(df_numero_alunos, select = c('Ano', 'desistentes_fundamental', 'desistentes_medio', 'chegam_ensino_medio'))
df_numero_alunos <- melt(df_numero_alunos, id = c("Ano"))
df_numero_alunos
df_numero_alunos <- ddply(dfMedias, .(Ano), summarize,  fundamental=sum(Total_fundamental),
medio=sum(Total_medio), infantil=sum(Total_infantil))
df_numero_alunos <- df_numero_alunos[(df_numero_alunos$Ano == '2010'),]
df_numero_alunos
df_numero_alunos$desistentes_fundamental <- (((df_numero_alunos$fundamental/df_numero_alunos$infantil) *100) - 100) * -1
df_numero_alunos$desistentes_medio <- (((df_numero_alunos$medio/df_numero_alunos$fundamental) *100) - 100) * -1
df_numero_alunos$chegam_ensino_medio <- ((df_numero_alunos$desistentes_fundamental + df_numero_alunos$desistentes_medio) - 100) * -1
df_numero_alunos <- subset(df_numero_alunos, select = c('Ano', 'desistentes_fundamental', 'desistentes_medio', 'chegam_ensino_medio'))
df_numero_alunos
melt(df_numero_alunos, id = c("Ano"))
df_numero_alunos <- melt(df_numero_alunos, id = c("Ano"))
p2 = ggplot(df_numero_alunos, aes(fill=df_numero_alunos$variable, ymax=100, ymin=0, xmax=4, xmin=3)) +
geom_rect(colour="grey30") +
coord_polar(theta="y") +
xlim(c(0, 4)) +
theme_bw() +
theme(panel.grid=element_blank()) +
theme(axis.text=element_blank()) +
theme(axis.ticks=element_blank()) +
labs(title="Customized ring plot")
ggplot(df_numero_alunos, aes(fill=df_numero_alunos$variable, ymax=100, ymin=0, xmax=4, xmin=3)) +
geom_rect(colour="grey30") +
coord_polar(theta="y") +
xlim(c(0, 4)) +
theme_bw() +
theme(panel.grid=element_blank()) +
theme(axis.text=element_blank()) +
theme(axis.ticks=element_blank()) +
labs(title="Customized ring plot")
ggplot(df_numero_alunos$value, aes(fill=df_numero_alunos$variable, ymax=100, ymin=0, xmax=4, xmin=3)) +
geom_rect(colour="grey30") +
coord_polar(theta="y") +
xlim(c(0, 4)) +
theme_bw() +
theme(panel.grid=element_blank()) +
theme(axis.text=element_blank()) +
theme(axis.ticks=element_blank()) +
labs(title="Customized ring plot")
df_numero_alunos
ggplot(df_numero_alunos, aes(x="", y = df_numero_alunos$value, fill = df_numero_alunos$Ano))+
geom_bar(width = 1, stat = "identity")
ggplot(df_numero_alunos, aes(x="", y = df_numero_alunos$value, fill = df_numero_alunos$variable))+
geom_bar(width = 1, stat = "identity")
ggplot(df_numero_alunos, aes(x="", y = df_numero_alunos$value, fill = df_numero_alunos$variable))+
geom_bar(width = 1, stat = "identity")+ coord_polar("y", start=0)
ggplot(df_numero_alunos, aes(x="", y = df_numero_alunos$value, fill = df_numero_alunos$variable),label="a")+
geom_bar(width = 1, stat = "identity")+ coord_polar("y", start=0)
ggplot(df_numero_alunos, aes(x="", y = df_numero_alunos$value, fill = df_numero_alunos$variable),label="a")+
geom_bar(width = 1, stat = "identity")+ coord_polar("y", start=0) +
geom_text(aes(y = 100,
label = percent(value/100)), size=5)
ggplot(df_numero_alunos, aes(x="", y = df_numero_alunos$value, fill = df_numero_alunos$variable),label="a")+
geom_bar(width = 1, stat = "identity")+ coord_polar("y", start=0) +
geom_text(aes(y = 100,
label =df_numero_alunos$variable))
ggplot(df_numero_alunos, aes(x="", y = df_numero_alunos$value, fill = df_numero_alunos$variable),label="a")+
geom_bar(width = 1, stat = "identity")+ coord_polar("y", start=0) +
geom_text(aes(y = 100,
label = df_numero_alunos$variable, size=5))
ggplot(df_numero_alunos, aes(x="", y = df_numero_alunos$value, fill = df_numero_alunos$variable),label="a")+
geom_bar(width = 1, stat = "identity")+ coord_polar("y", start=0)
ggplot(df_numero_alunos, aes(x="", y = df_numero_alunos$value, fill = df_numero_alunos$variable),label="a") +
geom_bar(width = 1, stat = "identity")+ coord_polar("y", start=0) +
geom_text(aes(x= factor(1), y=pos, label = df_numero_alunos$variable), size=10)
mutate(pos = cumsum(df_numero_alunos$value)- df_numero_alunos$value/2)
df_numero_alunos
mutate(pos = cumsum(df_numero_alunos$value)- df_numero_alunos$value/2)
pos <- mutate(pos = cumsum(df_numero_alunos$value)- df_numero_alunos$value/2)
library(ggpubr)
library(ggplot2)
library(plyr)
library(reshape)
#import dataFrame
df1 <- data.frame(read.csv(file = 'media_alunos_turma_municipios_2010 - Municípios SE, Sul e CO.csv',skip = 9, encoding = "UTF-8", sep = ','))
df2 <- data.frame(read.csv(file = 'media_alunos_turma_municipios_2010 - Municípios NO e NE.csv',skip = 9, encoding = "UTF-8", sep = ','))
#rename columns
colnames(df1) <- c("Ano", "Regiao", "UF", "Cod_municipio", "Municipio", "Localizacao","Rede","Total_infantil","Creche","Total_fundamental", "Anos_iniciais","Anos_finais","1_ano",
"2_ano","3_ano","4_ano","5_ano","6_ano","7_ano","8_ano","9_ano","Turmas_unificadas","Total_medio","1_medio","2_medio","3_medio","4_medio","Medio_nao_seriado")
colnames(df2) <- c("Ano", "Regiao", "UF", "Cod_municipio", "Municipio", "Localizacao","Rede","Total_infantil","Creche","Total_fundamental", "Anos_iniciais","Anos_finais","1_ano",
"2_ano","3_ano","4_ano","5_ano","6_ano","7_ano","8_ano","9_ano","Turmas_unificadas","Total_medio","1_medio","2_medio","3_medio","4_medio","Medio_nao_seriado")
# join regions
dfMedias <- data.frame(rbind(df1, df2))
# transform (--) to 0.0
dfMedias <- data.frame(lapply(dfMedias, function(x){gsub("--", 0.0, x)}))
##### Means Ensino Médio ########
# convert to numeric
dfMedias$Total_medio <- as.numeric(dfMedias$Total_medio)
##### Means all ########
# calculate mean by Regiao
df_mean_all <- ddply(dfMedias, .(Regiao), summarize,  fundamental=mean(Total_fundamental),
medio=mean(Total_medio), infantil=mean(Total_infantil))
# ignore values that don't have Regiao
df_mean_all <- df_mean_all[df_mean_all$Regiao != '',]
df_mean_all <- melt(df_mean_all, id = c("Regiao"))
# Bar chart
chart_media_all <- ggplot(df_mean_all, aes(x = df_mean_all$Regiao, y = df_mean_all$value, fill = factor(df_mean_all$variable))) +
geom_bar(stat = "identity", position=position_dodge()) +
labs(fill = "Ensino") +
xlab("Regiões do Brasil") + ylab("Média de alunos") +
ggtitle("Média de alunos por turma no ensino fundamental x médio x infantil no Brasil")
chart_media_all
df_numero_alunos <- ddply(dfMedias, .(Ano), summarize,  fundamental=sum(Total_fundamental),
medio=sum(Total_medio), infantil=sum(Total_infantil))
df_numero_alunos <- df_numero_alunos[(df_numero_alunos$Ano == '2010'),]
df_numero_alunos
df_numero_alunos$desistentes_fundamental <- (((df_numero_alunos$fundamental/df_numero_alunos$infantil) *100) - 100) * -1
df_numero_alunos$desistentes_medio <- (((df_numero_alunos$medio/df_numero_alunos$fundamental) *100) - 100) * -1
df_numero_alunos$chegam_ensino_medio <- ((df_numero_alunos$desistentes_fundamental + df_numero_alunos$desistentes_medio) - 100) * -1
df_numero_alunos <- subset(df_numero_alunos, select = c('Ano', 'desistentes_fundamental', 'desistentes_medio', 'chegam_ensino_medio'))
df_numero_alunos <- melt(df_numero_alunos, id = c("Ano"))
df_numero_alunos
pos <- mutate(pos = cumsum(df_numero_alunos$value)- df_numero_alunos$value/2)
bp <- ggplot(df_numero_alunos, aes(x="", y = df_numero_alunos$value, fill = df_numero_alunos$variable),label="a") +
geom_bar(width = 1, stat = "identity")+ coord_polar("y", start=0) +
geom_text(aes(x= factor(1), y=pos, label = df_numero_alunos$variable), size=10)
library(ggpubr)
library(ggplot2)
library(plyr)
library(reshape)
#import dataFrame
df1 <- data.frame(read.csv(file = 'media_alunos_turma_municipios_2010 - Municípios SE, Sul e CO.csv',skip = 9, encoding = "UTF-8", sep = ','))
df2 <- data.frame(read.csv(file = 'media_alunos_turma_municipios_2010 - Municípios NO e NE.csv',skip = 9, encoding = "UTF-8", sep = ','))
#rename columns
colnames(df1) <- c("Ano", "Regiao", "UF", "Cod_municipio", "Municipio", "Localizacao","Rede","Total_infantil","Creche","Total_fundamental", "Anos_iniciais","Anos_finais","1_ano",
"2_ano","3_ano","4_ano","5_ano","6_ano","7_ano","8_ano","9_ano","Turmas_unificadas","Total_medio","1_medio","2_medio","3_medio","4_medio","Medio_nao_seriado")
colnames(df2) <- c("Ano", "Regiao", "UF", "Cod_municipio", "Municipio", "Localizacao","Rede","Total_infantil","Creche","Total_fundamental", "Anos_iniciais","Anos_finais","1_ano",
"2_ano","3_ano","4_ano","5_ano","6_ano","7_ano","8_ano","9_ano","Turmas_unificadas","Total_medio","1_medio","2_medio","3_medio","4_medio","Medio_nao_seriado")
# join regions
dfMedias <- data.frame(rbind(df1, df2))
# transform (--) to 0.0
dfMedias <- data.frame(lapply(dfMedias, function(x){gsub("--", 0.0, x)}))
##### Means Ensino Médio ########
# convert to numeric
dfMedias$Total_medio <- as.numeric(dfMedias$Total_medio)
##### Means all ########
# calculate mean by Regiao
df_mean_all <- ddply(dfMedias, .(Regiao), summarize,  fundamental=mean(Total_fundamental),
medio=mean(Total_medio), infantil=mean(Total_infantil))
# ignore values that don't have Regiao
df_mean_all <- df_mean_all[df_mean_all$Regiao != '',]
df_mean_all <- melt(df_mean_all, id = c("Regiao"))
# Bar chart
chart_media_all <- ggplot(df_mean_all, aes(x = df_mean_all$Regiao, y = df_mean_all$value, fill = factor(df_mean_all$variable))) +
geom_bar(stat = "identity", position=position_dodge()) +
labs(fill = "Ensino") +
xlab("Regiões do Brasil") + ylab("Média de alunos") +
ggtitle("Média de alunos por turma no ensino fundamental x médio x infantil no Brasil")
chart_media_all
df_numero_alunos <- ddply(dfMedias, .(Ano), summarize,  fundamental=sum(Total_fundamental),
medio=sum(Total_medio), infantil=sum(Total_infantil))
df_numero_alunos <- df_numero_alunos[(df_numero_alunos$Ano == '2010'),]
df_numero_alunos
df_numero_alunos$desistentes_fundamental <- (((df_numero_alunos$fundamental/df_numero_alunos$infantil) *100) - 100) * -1
df_numero_alunos$desistentes_medio <- (((df_numero_alunos$medio/df_numero_alunos$fundamental) *100) - 100) * -1
df_numero_alunos$chegam_ensino_medio <- ((df_numero_alunos$desistentes_fundamental + df_numero_alunos$desistentes_medio) - 100) * -1
df_numero_alunos <- subset(df_numero_alunos, select = c('Ano', 'desistentes_fundamental', 'desistentes_medio', 'chegam_ensino_medio'))
df_numero_alunos <- melt(df_numero_alunos, id = c("Ano"))
df_numero_alunos
pos <- mutate(pos = cumsum(df_numero_alunos$value)- df_numero_alunos$value/2)
bp <- ggplot(df_numero_alunos, aes(x="", y = df_numero_alunos$value, fill = df_numero_alunos$variable),label="a") +
geom_bar(width = 1, stat = "identity")+ coord_polar("y", start=0) +
geom_text(aes(x= factor(1), y=pos, label = df_numero_alunos$variable), size=10)
bp
chart_media_all
##### Means all ########
# calculate mean by Regiao
df_mean_all <- ddply(dfMedias, .(Regiao), summarize,  fundamental=mean(Total_fundamental),
medio=mean(Total_medio), infantil=mean(Total_infantil))
##### Means all ########
# calculate mean by Regiao
df_mean_all <- ddply(dfMedias, .(Regiao), summarize,  fundamental=mean(Total_fundamental),
medio=mean(Total_medio), infantil=mean(Total_infantil))
df_mean_all
#import dataFrame
df1 <- data.frame(read.csv(file = 'media_alunos_turma_municipios_2010 - Municípios SE, Sul e CO.csv',skip = 9, encoding = "UTF-8", sep = ','))
df2 <- data.frame(read.csv(file = 'media_alunos_turma_municipios_2010 - Municípios NO e NE.csv',skip = 9, encoding = "UTF-8", sep = ','))
#rename columns
colnames(df1) <- c("Ano", "Regiao", "UF", "Cod_municipio", "Municipio", "Localizacao","Rede","Total_infantil","Creche","Total_fundamental", "Anos_iniciais","Anos_finais","1_ano",
"2_ano","3_ano","4_ano","5_ano","6_ano","7_ano","8_ano","9_ano","Turmas_unificadas","Total_medio","1_medio","2_medio","3_medio","4_medio","Medio_nao_seriado")
colnames(df2) <- c("Ano", "Regiao", "UF", "Cod_municipio", "Municipio", "Localizacao","Rede","Total_infantil","Creche","Total_fundamental", "Anos_iniciais","Anos_finais","1_ano",
"2_ano","3_ano","4_ano","5_ano","6_ano","7_ano","8_ano","9_ano","Turmas_unificadas","Total_medio","1_medio","2_medio","3_medio","4_medio","Medio_nao_seriado")
# join regions
dfMedias <- data.frame(rbind(df1, df2))
# join regions
dfMedias <- data.frame(rbind(df1, df2))
# transform (--) to 0.0
dfMedias <- data.frame(lapply(dfMedias, function(x){gsub("--", 0.0, x)}))
# convert to numeric
dfMedias$Total_medio <- as.numeric(dfMedias$Total_medio)
##### Means all ########
# calculate mean by Regiao
df_mean_all <- ddply(dfMedias, .(Regiao), summarize,  fundamental=mean(Total_fundamental),
medio=mean(Total_medio), infantil=mean(Total_infantil))
df_mean_all
setwd("C:/RFundamentos/media_notas_brasil")
install.packages("ggplot2")
install.packages("ggpubr")
install.packages("ggpubr")
install.packages("reshape")
install.packages("ggplot2")
install.packages("ggplot2")
install.packages("ggplot2")
install.packages("ggplot2")
install.packages("ggplot2")
library(ggpubr)
library(ggplot2)
library(plyr)
library(reshape)
#import dataFrame
df1 <- data.frame(read.csv(file = 'media_alunos_turma_municipios_2010 - Municípios SE, Sul e CO.csv',skip = 9, encoding = "UTF-8", sep = ','))
df2 <- data.frame(read.csv(file = 'media_alunos_turma_municipios_2010 - Municípios NO e NE.csv',skip = 9, encoding = "UTF-8", sep = ','))
#rename columns
colnames(df1) <- c("Ano", "Regiao", "UF", "Cod_municipio", "Municipio", "Localizacao","Rede","Total_infantil","Creche","Total_fundamental", "Anos_iniciais","Anos_finais","1_ano",
"2_ano","3_ano","4_ano","5_ano","6_ano","7_ano","8_ano","9_ano","Turmas_unificadas","Total_medio","1_medio","2_medio","3_medio","4_medio","Medio_nao_seriado")
colnames(df2) <- c("Ano", "Regiao", "UF", "Cod_municipio", "Municipio", "Localizacao","Rede","Total_infantil","Creche","Total_fundamental", "Anos_iniciais","Anos_finais","1_ano",
"2_ano","3_ano","4_ano","5_ano","6_ano","7_ano","8_ano","9_ano","Turmas_unificadas","Total_medio","1_medio","2_medio","3_medio","4_medio","Medio_nao_seriado")
# join regions
dfMedias <- data.frame(rbind(df1, df2))
# transform (--) to 0.0
dfMedias <- data.frame(lapply(dfMedias, function(x){gsub("--", 0.0, x)}))
# convert to numeric
dfMedias$Total_medio <- as.numeric(dfMedias$Total_medio)
# convert to numeric
dfMedias$Total_medio <- as.numeric(dfMedias$Total_medio)
dfMedias$Total_infantil <- as.numeric(dfMedias$Total_infantil)
dfMedias$Total_fundamental <- as.numeric(dfMedias$Total_fundamental)
# calculate mean by Regiao
df_medio_uf <- ddply(dfMedias, .(Regiao), summarize,  Media=mean(Total_medio))
df_medio_uf
##### Means all ########
# calculate mean by Regiao
df_mean_all <- ddply(dfMedias, .(Regiao), summarize,  fundamental=mean(Total_fundamental),
medio=mean(Total_medio), infantil=mean(Total_infantil))
df_mean_all
# ignore values that don't have Regiao
df_mean_all <- df_mean_all[df_mean_all$Regiao != '',]
df_mean_all <- melt(df_mean_all, id = c("Regiao"))
# Bar chart ALL
chart_media_all <- ggplot(df_mean_all, aes(x = df_mean_all$Regiao, y = df_mean_all$value, fill = factor(df_mean_all$variable))) +
geom_bar(stat = "identity", position=position_dodge()) +
labs(fill = "Ensino") +
xlab("RegiÃµes do Brasil") + ylab("MÃ©dia") +
ggtitle("MÃ©dia de notas no ensino fundamental x mÃ©dio x infantil no Brasil")
chart_media_all
# Bar chart ALL
chart_media_all <- ggplot(df_mean_all, aes(x = df_mean_all$Regiao, y = df_mean_all$value, fill = factor(df_mean_all$variable))) +
geom_bar(stat = "identity", position=position_dodge()) +
labs(fill = "Ensino") +
xlab("RegiÃµes do Brasil") + ylab("Média") +
ggtitle("Média de alunos por turma no ensino fundamental x médio x infantil no Brasil")
chart_media_all
# Bar chart ALL
chart_media_all <- ggplot(df_mean_all, aes(x = df_mean_all$Regiao, y = df_mean_all$value, fill = factor(df_mean_all$variable))) +
geom_bar(stat = "identity", position=position_dodge()) +
labs(fill = "Ensino") +
xlab("Regiões do Brasil") + ylab("Média") +
ggtitle("Média de alunos por turma no ensino fundamental x médio x infantil no Brasil")
chart_media_all
ggarrange(chart_mean_medio, chart_mean_infantil, chart_mean_fundamental,
ncol = 2, nrow = 2)
###### Media alunos desistentes #########
df_numero_alunos <- ddply(dfMedias, .(Ano), summarize,  fundamental=sum(Total_fundamental),
medio=sum(Total_medio), infantil=sum(Total_infantil))
df_numero_alunos <- df_numero_alunos[(df_numero_alunos$Ano == '2010'),]
df_numero_alunos
df_numero_alunos$desistentes_fundamental <- (((df_numero_alunos$fundamental/df_numero_alunos$infantil) *100) - 100) * -1
df_numero_alunos$desistentes_medio <- (((df_numero_alunos$medio/df_numero_alunos$fundamental) *100) - 100) * -1
df_numero_alunos$chegam_ensino_medio <- ((df_numero_alunos$desistentes_fundamental + df_numero_alunos$desistentes_medio) - 100) * -1
df_numero_alunos <- subset(df_numero_alunos, select = c('Ano', 'desistentes_fundamental', 'desistentes_medio', 'chegam_ensino_medio'))
df_numero_alunos <- melt(df_numero_alunos, id = c("Ano"))
df_numero_alunos
bp <- ggplot(df_numero_alunos, aes(x="", y = df_numero_alunos$value, fill = df_numero_alunos$variable),label="a") +
geom_bar(width = 1, stat = "identity")+ coord_polar("y", start=0)
bp
bp
bp <- ggplot(df_numero_alunos, aes(x="", y = df_numero_alunos$value, fill = df_numero_alunos$variable),label="a") +
geom_bar(width = 1, stat = "identity")+ coord_polar("y", start=0)
bp
ggplot(df_numero_alunos, aes(x="", y = df_numero_alunos$value, fill = df_numero_alunos$variable),label="a") +
geom_bar(width = 1, stat = "identity")+ coord_polar("y", start=0)
ggplot(df_numero_alunos, aes(x="", y = df_numero_alunos$value, fill = df_numero_alunos$variable),label="a")
ggplot(df_numero_alunos, aes(x="", y = df_numero_alunos$value, fill = df_numero_alunos$variable
bp <- ggplot(df_numero_alunos, aes(x="", y = df_numero_alunos$value, fill = df_numero_alunos$variable)) +
geom_bar(width = 1, stat = "identity")+ coord_polar("y", start=0)
bp <- ggplot(df_numero_alunos, aes(x="", y = df_numero_alunos$value, fill = df_numero_alunos$variable)) +
geom_bar(width = 1, stat = "identity")
bp
bp <- ggplot(df_numero_alunos, aes(x="", y = df_numero_alunos$value, fill = df_numero_alunos$variable)) +
geom_bar(width = 1, stat = "identity")
bp
bp<- ggplot(df_numero_alunos, aes(x="", y=df_numero_alunos$value, fill=df_numero_alunos$variable))+
geom_bar(width = 1, stat = "identity")
bp
bp
chart_media_all
# Bar chart ALL
chart_media_all <- ggplot(df_mean_all, aes(x = df_mean_all$Regiao, y = df_mean_all$value, fill = factor(df_mean_all$variable))) +
geom_bar(stat = "identity", position=position_dodge()) +
labs(fill = "Ensino") +
xlab("Regiões do Brasil") + ylab("Média") +
ggtitle("Média de alunos por turma no ensino fundamental x médio x infantil no Brasil")
chart_media_all
#import dataFrame
df1 <- data.frame(read.csv(file = 'media_alunos_turma_municipios_2010 - Municípios SE, Sul e CO.csv',skip = 9, encoding = "UTF-8", sep = ','))
df2 <- data.frame(read.csv(file = 'media_alunos_turma_municipios_2010 - Municípios NO e NE.csv',skip = 9, encoding = "UTF-8", sep = ','))
#rename columns
colnames(df1) <- c("Ano", "Regiao", "UF", "Cod_municipio", "Municipio", "Localizacao","Rede","Total_infantil","Creche","Total_fundamental", "Anos_iniciais","Anos_finais","1_ano",
"2_ano","3_ano","4_ano","5_ano","6_ano","7_ano","8_ano","9_ano","Turmas_unificadas","Total_medio","1_medio","2_medio","3_medio","4_medio","Medio_nao_seriado")
colnames(df2) <- c("Ano", "Regiao", "UF", "Cod_municipio", "Municipio", "Localizacao","Rede","Total_infantil","Creche","Total_fundamental", "Anos_iniciais","Anos_finais","1_ano",
"2_ano","3_ano","4_ano","5_ano","6_ano","7_ano","8_ano","9_ano","Turmas_unificadas","Total_medio","1_medio","2_medio","3_medio","4_medio","Medio_nao_seriado")
# join regions
dfMedias <- data.frame(rbind(df1, df2))
# transform (--) to 0.0
dfMedias <- data.frame(lapply(dfMedias, function(x){gsub("--", 0.0, x)}))
##### Means Ensino MÃ©dio ########
# convert to numeric
dfMedias$Total_medio <- as.numeric(dfMedias$Total_medio)
dfMedias$Total_infantil <- as.numeric(dfMedias$Total_infantil)
dfMedias$Total_fundamental <- as.numeric(dfMedias$Total_fundamental)
##### Means all ########
# calculate mean by Regiao
df_mean_all <- ddply(dfMedias, .(Regiao), summarize,  fundamental=mean(Total_fundamental),
medio=mean(Total_medio), infantil=mean(Total_infantil))
# ignore values that don't have Regiao
df_mean_all <- df_mean_all[df_mean_all$Regiao != '',]
df_mean_all <- melt(df_mean_all, id = c("Regiao"))
###### Media alunos desistentes #########
df_numero_alunos <- ddply(dfMedias, .(Ano), summarize,  fundamental=sum(Total_fundamental),
medio=sum(Total_medio), infantil=sum(Total_infantil))
df_numero_alunos <- df_numero_alunos[(df_numero_alunos$Ano == '2010'),]
df_numero_alunos
df_numero_alunos$desistentes_fundamental <- (((df_numero_alunos$fundamental/df_numero_alunos$infantil) *100) - 100) * -1
df_numero_alunos$desistentes_medio <- (((df_numero_alunos$medio/df_numero_alunos$fundamental) *100) - 100) * -1
df_numero_alunos$chegam_ensino_medio <- ((df_numero_alunos$desistentes_fundamental + df_numero_alunos$desistentes_medio) - 100) * -1
df_numero_alunos <- subset(df_numero_alunos, select = c('Ano', 'desistentes_fundamental', 'desistentes_medio', 'chegam_ensino_medio'))
df_numero_alunos <- melt(df_numero_alunos, id = c("Ano"))
df_numero_alunos
##### CHARTS ############
# Bar chart ALL
chart_media_all <- ggplot(df_mean_all, aes(x = df_mean_all$Regiao, y = df_mean_all$value, fill = factor(df_mean_all$variable))) +
geom_bar(stat = "identity", position=position_dodge()) +
labs(fill = "Ensino") +
xlab("Regiões do Brasil") + ylab("Média") +
ggtitle("Média de alunos por turma no ensino fundamental x médio x infantil no Brasil")
chart_media_all
bp<- ggplot(df_numero_alunos, aes(x="", y=df_numero_alunos$value, fill=df_numero_alunos$variable))+
geom_bar(width = 1, stat = "identity")
bp
bp
