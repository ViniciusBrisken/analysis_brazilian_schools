GeoStates <- gvisGeoChart(df_sum_uf, "UF_completo", "total",
options=list(region="BR",
displayMode="regions",
resolution="provinces",
width=900, height=900))
plot(GeoStates)
GeoStates <- gvisGeoChart(df_sum_uf, "UF_completo", "total",
options=list(region="BR",
displayMode="regions",
resolution="provinces",
width=800, height=800))
plot(GeoStates)
GeoStates <- gvisGeoChart(df_sum_uf, "UF_completo", "total",colorvar='Profit',
options=list(region="BR",
displayMode="regions",
resolution="provinces",
width=800, height=800))
plot(GeoStates)
GeoStates <- gvisGeoChart(df_sum_uf, "UF_completo", "total",
options=list(region="BR",
displayMode="regions",
resolution="provinces",
width=800, height=800,
colorAxis="{colors:['red', 'grey']}"))
plot(GeoStates)
GeoStates <- gvisGeoChart(df_sum_uf, "UF_completo", "total",
options=list(region="BR",
displayMode="regions",
resolution="provinces",
width=800, height=800,
colorAxis="{colors:['blue', 'grey']}"))
plot(GeoStates)
GeoStates <- gvisGeoChart(df_sum_uf, "UF_completo", "total",
options=list(region="BR",
displayMode="regions",
resolution="provinces",
width=800, height=800,
colorAxis="{colors:['light-blue', 'blue']}"))
plot(GeoStates)
GeoStates <- gvisGeoChart(df_sum_uf, "UF_completo", "total",
options=list(region="BR",
displayMode="regions",
resolution="provinces",
width=800, height=800,
colorAxis="{colors:['orange', 'blue']}"))
plot(GeoStates)
GeoStates <- gvisGeoChart(df_sum_uf, "UF_completo", "total",
options=list(region="BR",
displayMode="regions",
resolution="provinces",
width=800, height=800,
colorAxis="{colors:['orange'}"))
plot(GeoStates)
GeoStates <- gvisGeoChart(df_sum_uf, "UF_completo", "total",
options=list(region="BR",
displayMode="regions",
resolution="provinces",
width=800, height=800,
colorAxis="{colors:['blue'}"))
plot(GeoStates)
GeoStates <- gvisGeoChart(df_sum_uf, "UF_completo", "total",
options=list(region="BR",
displayMode="regions",
resolution="provinces",
width=800, height=800,
colorAxis="{colors:['#99ff99', '#ff8566'}"))
plot(GeoStates)
GeoStates <- gvisGeoChart(df_sum_uf, "UF_completo", "total",
options=list(region="BR",
displayMode="regions",
resolution="provinces",
width=800, height=800,
colorAxis="{colors:['#99ff99', '#ff8566']}"))
plot(GeoStates)
GeoStates <- gvisGeoChart(df_sum_uf, "UF_completo", "total",
options=list(region="BR",
displayMode="regions",
resolution="provinces",
width=800, height=800,
colorAxis="{colors:['#80ccff', '#ff8566']}"))
plot(GeoStates)
GeoStates <- gvisGeoChart(df_sum_uf, "UF_completo", "total",
options=list(region="BR",
displayMode="regions",
resolution="provinces",
width=800, height=800,
colorAxis="{colors:['#99ff99', '#80ccff']}"))
plot(GeoStates)
GeoStates <- gvisGeoChart(df_sum_uf, "UF_completo", "total",
options=list(region="BR",
displayMode="regions",
resolution="provinces",
width=800, height=800,
colorAxis="{colors:['#80ccff', '#007acc']}"))
plot(GeoStates)
GeoStates <- gvisGeoChart(df_sum_uf, "UF_completo", "total",
options=list(region="BR",
displayMode="regions",
resolution="provinces",
width=800, height=800,
colorAxis="{colors:['#80ccff', '#005c99']}"))
plot(GeoStates)
GeoStates <- gvisGeoChart(df_sum_uf, "UF_completo", "total",
options=list(region="BR",
displayMode="regions",
resolution="provinces",
width=800, height=800,
colorAxis="{colors:['#ccebff', '#005c99']}"))
GeoStates <- gvisGeoChart(df_sum_uf, "UF_completo", "total",
options=list(region="BR",
displayMode="regions",
resolution="provinces",
width=800, height=800,
colorAxis="{colors:['#ccebff', '#005c99']}"))
plot(GeoStates)
GeoStates <- gvisGeoChart(df_sum_uf, "UF_completo", "total",
options=list(region="BR",
displayMode="regions",
resolution="provinces",
width=800, height=800,
vAxes="[{title:'val1'}, {title:'val2'}]",
colorAxis="{colors:['#ccebff', '#005c99']}"))
plot(GeoStates)
GeoStates <- gvisGeoChart(df_sum_uf, locationvar = "UF_completo", colorvar = "total", hovervar = "AA",
options=list(region="BR",
displayMode="regions",
resolution="provinces",
width=800, height=800,
vAxes="[{title:'val1'}, {title:'val2'}]",
colorAxis="{colors:['#ccebff', '#005c99']}"))
GeoStates <- gvisGeoChart(df_sum_uf, locationvar = "UF_completo", colorvar = "total", hovervar = "UF",
options=list(region="BR",
displayMode="regions",
resolution="provinces",
width=800, height=800,
vAxes="[{title:'val1'}, {title:'val2'}]",
colorAxis="{colors:['#ccebff', '#005c99']}"))
plot(GeoStates)
GeoStates <- gvisGeoChart(df_sum_uf, locationvar = "UF_completo", colorvar = "total", hovervar = "UF",
options=list(region="BR",
displayMode="regions",
resolution="provinces",
width=800, height=800,
vAxes="[{title:'val1'}, {title:'val2'}]",
colorAxis="{colors:['#ccebff', '#005c99']}")) + "AAAAAAAAAAAAAAAA"
GeoStates <- gvisGeoChart(df_sum_uf, locationvar = "UF_completo", colorvar = "total", hovervar = "UF",
options=list(region="BR",
displayMode="regions",
resolution="provinces",
width=800, height=800,
title='TESTING MAPS',
colorAxis="{colors:['#ccebff', '#005c99']}"))
plot(GeoStates)
GeoStates <- gvisMap(df_sum_uf, locationvar = "UF_completo", colorvar = "total", hovervar = "UF",
options=list(region="BR",
displayMode="regions",
resolution="provinces",
width=800, height=800,
title='TESTING MAPS',
colorAxis="{colors:['#ccebff', '#005c99']}"))
gvisGeoChart
gvisGeoChart
GeoStates <- gvisGeoChart(df_sum_uf, locationvar = "UF_completo", colorvar = "total", hovervar = "UF",
options=list(region="BR",
displayMode="regions",
resolution="provinces",
width=800, height=800,
title='TESTING MAPS',
colorAxis="{colors:['#ccebff', '#005c99']}"))
plot(GeoStates)
GeoStates <- gvisIntensityMap(df_sum_uf, locationvar = "UF_completo", colorvar = "total", hovervar = "UF",
options=list(region="BR",
displayMode="regions",
resolution="provinces",
width=800, height=800,
title='TESTING MAPS',
colorAxis="{colors:['#ccebff', '#005c99']}"))
gvisGeoChart
GeoStates <- gvisGeoChart(df_sum_uf, locationvar = "UF_completo", colorvar = "total", hovervar = "UF",
options=list(region="BR",
displayMode="regions",
resolution="provinces",
width=800, height=800,
title='TESTING MAPS',
colorAxis="{colors:['#ccebff', '#005c99']}"))
plot(GeoStates)
GeoStates
GeoStates
chart_geo_total_alunos <- gvisGeoChart(df_sum_uf, locationvar = "UF_completo", colorvar = "total", hovervar = "UF",
options=list(region="BR",
displayMode="regions",
resolution="provinces",
width=800, height=800,
title='TESTING MAPS',
colorAxis="{colors:['#ccebff', '#005c99']}"))
ggarrange(chart_geo_total_alunos,  ncol = 2, nrow = 2)
gvisGeoChart(df_sum_uf, locationvar = "UF_completo", colorvar = "total", hovervar = "UF",
options=list(region="BR",
displayMode="regions",
resolution="provinces",
width=800, height=800,
title='TESTING MAPS',
colorAxis="{colors:['#ccebff', '#005c99']}"))
###### Média de alunos por estado
df_mean_uf <- ddply(dfMedias, .(UF), summarize,  total=mean(Total_fundamental + Total_medio + Total_infantil))
# ignore values that don't have Regiao
df_mean_uf <- df_mean_uf[df_sum_uf$UF != '',]
#formata UF
df_mean_uf$UF_completo <- mapply(function(x) gsub(x, paste("BR-",x, sep=""), x),
df_mean_uf$UF)
chart_geo_mean_alunos <- gvisGeoChart(df_mean_uf, locationvar = "UF_completo", colorvar = "total", hovervar = "UF",
options=list(region="BR",
displayMode="regions",
resolution="provinces",
width=800, height=800,
title='TESTING MAPS',
colorAxis="{colors:['#ccebff', '#005c99']}"))
plot(GeoStates)
chart_geo_mean_alunos <- gvisGeoChart(df_mean_uf, locationvar = "UF_completo", colorvar = "total", hovervar = "UF",
options=list(region="BR",
displayMode="regions",
resolution="provinces",
width=800, height=800,
title='TESTING MAPS',
colorAxis="{colors:['#ccebff', '#005c99']}"))
plot(chart_geo_mean_alunos)
###### Média de alunos por estado
df_mean_uf <- ddply(dfMedias, .(UF), summarize,  total=sum(Total_fundamental + Total_medio + Total_infantil))
df_mean_uf$total /3
###### Média de alunos por estado
df_mean_uf <- ddply(dfMedias, .(UF), summarize,  total=mean(Total_fundamental),
total2 = mean(Total_medio),
total3 = mean(Total_infantil))
df_mean_uf
(df_mean_uf$total + df_mean_uf$total2 + df_mean_uf$total3) / 3
df_mean_uf$total <- (df_mean_uf$total + df_mean_uf$total2 + df_mean_uf$total3) / 3
# ignore values that don't have Regiao
df_mean_uf <- df_mean_uf[df_sum_uf$UF != '',]
#formata UF
df_mean_uf$UF_completo <- mapply(function(x) gsub(x, paste("BR-",x, sep=""), x),
df_mean_uf$UF)
# Map chart média de alunos por sala
chart_geo_mean_alunos <- gvisGeoChart(df_mean_uf, locationvar = "UF_completo", colorvar = "total", hovervar = "UF",
options=list(region="BR",
displayMode="regions",
resolution="provinces",
width=800, height=800,
title='TESTING MAPS',
colorAxis="{colors:['#ccebff', '#005c99']}"))
plot(chart_geo_mean_alunos)
ggarrange(chart_total_regiao_ensino, chart_media_all, chart_rede_total,  ncol = 2, nrow = 2)
# Bar chart total de alunos por regiao x ensino
chart_total_regiao_ensino <- ggplot(df_sum_reg, aes(x = df_sum_reg$Regiao, y = df_sum_reg$value/1000, fill = factor(df_sum_reg$variable))) +
geom_bar(stat = "identity", position=position_dodge()) +
labs(fill = "Ensino") +
xlab("Regiões do Brasil") + ylab("Total (Mil)") +
ggtitle("Total de alunos por ensino nas regiões do Brasil")
# Bar chart Média de alunos por turma
chart_media_all <- ggplot(df_mean_all, aes(x = df_mean_all$Regiao, y = df_mean_all$value, fill = factor(df_mean_all$variable))) +
geom_bar(stat = "identity", position=position_dodge()) +
labs(fill = "Ensino") +
xlab("Regiões do Brasil") + ylab("Média") +
ggtitle("Média de alunos por turma no ensino fundamental x médio x infantil no Brasil")
# Bar chart total de alunos nas redes municipais, estaduais e privadas
chart_rede_total <- ggplot(df_total_alunos_rede, aes(x = df_total_alunos_rede$Rede, y = df_total_alunos_rede$total/1000000, fill = factor(df_total_alunos_rede$Rede))) +
geom_bar(stat = "identity", position=position_dodge()) +
labs(fill = "Redes de ensino") +
xlab("Rede") + ylab("Total (M)") +
ggtitle("Total de alunos por rede de ensino no Brasil")
ggarrange(chart_total_regiao_ensino, chart_media_all, chart_rede_total,  ncol = 2, nrow = 2)
e alunos por turma
chart_media_all <- ggplot(df_mean_all, aes(x = df_mean_all$Regiao, y = df_mean_all$value, fill = factor(df_mean_all$variable))) +
geom_bar(stat = "identity", position=position_dodge()) +
labs(fill = "Ensino") +
xlab("Regiões do Brasil") + ylab("Média") +
ggtitle("Média de alunos por turma no ensino fundamental x médio x infantil no Brasil")
ggplot(df_numero_alunos, aes(x="", y=df_numero_alunos$value, fill=df_numero_alunos$variable))+
geom_bar(width = 1, stat = "identity")+
coord_polar("y", start=0)+
labs(fill = "Período escolar")+
ggtitle("Porcentagem de alunos que chegam ao ensino médio no Brasil")+
ylab("% de alunos")
library(tidyr)
library(ggpubr)
library(ggplot2)
library(plyr)
library(reshape)
library(scales)
library(googleVis)
library(readr)
library(dplyr)
library(tidyr)
library(ggpubr)
library(ggplot2)
library(plyr)
library(reshape)
library(scales)
library(googleVis)
library(readr)
library(dplyr)
library(tidyr)
df1 <- read_csv("media_alunos_turma_municipios_2010 - Municipios SE, Sul e CO.csv",
skip = 9,
col_names= c("Ano", "Regiao", "UF", "Cod_municipio", "Municipio", "Localizacao",
"Rede","Total_infantil","Creche","Total_fundamental", "Anos_iniciais",
"Anos_finais","1_ano","2_ano","3_ano","4_ano","5_ano","6_ano","7_ano",
"8_ano","9_ano","Turmas_unificadas","Total_medio","1_medio","2_medio",
"3_medio","4_medio","Medio_nao_seriado"),
col_types = list(
Total_medio = col_double(),
Total_infantil = col_double(),
Total_fundamental = col_double()
))
setwd("C:/RFundamentos/media_notas_brasil")
df1 <- read_csv("media_alunos_turma_municipios_2010 - Municipios SE, Sul e CO.csv",
skip = 9,
col_names= c("Ano", "Regiao", "UF", "Cod_municipio", "Municipio", "Localizacao",
"Rede","Total_infantil","Creche","Total_fundamental", "Anos_iniciais",
"Anos_finais","1_ano","2_ano","3_ano","4_ano","5_ano","6_ano","7_ano",
"8_ano","9_ano","Turmas_unificadas","Total_medio","1_medio","2_medio",
"3_medio","4_medio","Medio_nao_seriado"),
col_types = list(
Total_medio = col_double(),
Total_infantil = col_double(),
Total_fundamental = col_double()
))
df2 <- read_csv("media_alunos_turma_municipios_2010 - Municipios NO e NE.csv",
skip = 9,
col_names= c("Ano", "Regiao", "UF", "Cod_municipio", "Municipio", "Localizacao",
"Rede","Total_infantil","Creche","Total_fundamental", "Anos_iniciais",
"Anos_finais","1_ano","2_ano","3_ano","4_ano","5_ano","6_ano","7_ano",
"8_ano","9_ano","Turmas_unificadas","Total_medio","1_medio","2_medio",
"3_medio","4_medio","Medio_nao_seriado"),
col_types = list(
Total_medio = col_double(),
Total_infantil = col_double(),
Total_fundamental = col_double()
))
# join regions and organize data
dfMedias <- data.frame(rbind(df1, df2)) %>%
select(Ano, Regiao, Rede, UF, Municipio, Total_medio,Total_infantil, Total_fundamental ) %>%
filter( Rede == 'Estadual' | Rede == 'Municipal'| Rede == 'Privada') %>%
replace(., is.na(.), 0.0) %>%
group_by(Ano, Regiao, Rede, UF, Municipio) %>%
summarise(Total_medio = max(Total_medio), Total_infantil = max(Total_infantil), Total_fundamental = max(Total_fundamental))
##### total of students per region #####
?gather
dfMedias %>%
group_by(Regiao) %>%
summarise(fundamental=sum(Total_fundamental), medio=sum(Total_medio), infantil=sum(Total_infantil)) %>%
gather(id, Regiao)
dfMedias %>%
group_by(Regiao) %>%
summarise(fundamental=sum(Total_fundamental), medio=sum(Total_medio), infantil=sum(Total_infantil)) %>%
gather(id, Regiao, Total_fundamental: Total_infantil:Total_medio )
dfMedias %>%
group_by(Regiao) %>%
summarise(fundamental=sum(Total_fundamental), medio=sum(Total_medio), infantil=sum(Total_infantil)) %>%
gather(id, Regiao, fundamental: medio:infantil )
dfMedias %>%
group_by(Regiao) %>%
summarise(fundamental=sum(Total_fundamental), medio=sum(Total_medio), infantil=sum(Total_infantil))
dfMedias %>%
group_by(Regiao) %>%
summarise(fundamental=sum(Total_fundamental), medio=sum(Total_medio), infantil=sum(Total_infantil)) %>%
gather(id, Regiao)
dfMedias %>%
group_by(Regiao) %>%
summarise(fundamental=sum(Total_fundamental), medio=sum(Total_medio), infantil=sum(Total_infantil)) %>%
gather(id, fundamental)
dfMedias %>%
group_by(Regiao) %>%
summarise(fundamental=sum(Total_fundamental), medio=sum(Total_medio), infantil=sum(Total_infantil)) %>%
gather(id, Regiao, -Regiao)
dfMedias %>%
group_by(Regiao) %>%
summarise(fundamental=sum(Total_fundamental), medio=sum(Total_medio), infantil=sum(Total_infantil)) %>%
gather(id, Regiao, -fundamental)
dfMedias %>%
group_by(Regiao) %>%
summarise(fundamental=sum(Total_fundamental), medio=sum(Total_medio), infantil=sum(Total_infantil)) %>%
gather(id, fundamental:medio:infantil, -Regiao)
dfMedias %>%
group_by(Regiao) %>%
summarise(fundamental=sum(Total_fundamental), medio=sum(Total_medio), infantil=sum(Total_infantil)) %>%
gather(id, total, -Regiao)
dfMedias %>%
group_by(Regiao) %>%
summarise(fundamental=sum(Total_fundamental), medio=sum(Total_medio), infantil=sum(Total_infantil)) %>%
gather(id, total)
dfMedias %>%
group_by(Regiao) %>%
summarise(fundamental=sum(Total_fundamental), medio=sum(Total_medio), infantil=sum(Total_infantil)) %>%
gather(id, total, -Regiao)
dfMedias %>%
group_by(Regiao) %>%
summarise(fundamental=sum(Total_fundamental), medio=sum(Total_medio), infantil=sum(Total_infantil)) %>%
gather(id, value, -Regiao)
dfMedias %>%
group_by(Regiao) %>%
summarise(fundamental=sum(Total_fundamental), medio=sum(Total_medio), infantil=sum(Total_infantil)) %>%
gather(variable, value, -Regiao)
##### total of students per region #####
df_sum_reg <- dfMedias %>%
group_by(Regiao) %>%
summarise(fundamental=sum(Total_fundamental), medio=sum(Total_medio), infantil=sum(Total_infantil)) %>%
gather(variable, value, -Regiao)
ggplot(df_sum_reg, aes(x = df_sum_reg$Regiao, y = df_sum_reg$value/1000, fill = factor(df_sum_reg$variable))) +
geom_bar(stat = "identity", position=position_dodge()) +
labs(fill = "Ensino") +
xlab("Regiões do Brasil") + ylab("Total (Mil)") +
ggtitle("Total de alunos por ensino nas regiões do Brasil")
ggplot(df_sum_reg, aes(x = df_sum_reg$variable, y = df_sum_reg$value/1000, fill = factor(df_sum_reg$variable))) +
geom_bar(stat = "identity", position=position_dodge()) +
labs(fill = "Ensino") +
xlab("Regiões do Brasil") + ylab("Total (Mil)") +
ggtitle("Total de alunos por ensino nas regiões do Brasil")
ggplot(df_sum_reg, aes(x = df_sum_reg$Regiao, y = df_sum_reg$value/1000, fill = factor(df_sum_reg$variable))) +
geom_bar(stat = "identity", position=position_dodge()) +
labs(fill = "Ensino") +
xlab("Regiões do Brasil") + ylab("Total (Mil)") +
ggtitle("Total de alunos por ensino nas regiões do Brasil")
View(df1)
dfMedias %>%
group_by(Regiao) %>%
summarise(fundamental=mean(Total_fundamental), medio=mean(Total_medio), infantil=mean(Total_infantil)) %>%
gather(variable, value, -Regiao)
##### Mean students per region #####
df_mean_all <- dfMedias %>%
group_by(Regiao) %>%
summarise(fundamental=mean(Total_fundamental), medio=mean(Total_medio), infantil=mean(Total_infantil)) %>%
gather(variable, value, -Regiao)
ggplot(df_mean_all, aes(x = df_mean_all$Regiao, y = df_mean_all$value, fill = factor(df_mean_all$variable))) +
geom_bar(stat = "identity", position=position_dodge()) +
labs(fill = "Ensino") +
xlab("Regiões do Brasil") + ylab("Média") +
ggtitle("Média de alunos por turma no ensino fundamental x médio x infantil no Brasil")
# join regions and organize data
dfMedias <- data.frame(rbind(df1, df2)) %>%
select(Ano, Regiao, Rede, UF, Municipio, Total_medio,Total_infantil, Total_fundamental ) %>%
filter( Rede == 'Estadual' | Rede == 'Municipal'| Rede == 'Privada') %>%
replace(., is.na(.), 0.0) %>%
group_by(Ano, Regiao, Rede, UF, Municipio) %>%
summarise(Total_medio = max(Total_medio), Total_infantil = max(Total_infantil), Total_fundamental = max(Total_fundamental))
# join regions and organize data
dfMedias <- data.frame(rbind(df1, df2)) %>%
select(Ano, Regiao, Rede, UF, Municipio, Total_medio,Total_infantil, Total_fundamental ) %>%
filter( Rede == 'Estadual' | Rede == 'Municipal'| Rede == 'Privada') %>%
replace(., is.na(.), 0.0) %>%
group_by(Ano, Regiao, Rede, UF, Municipio) %>%
summarise(Total_medio = mean(Total_medio), Total_infantil = mean(Total_infantil), Total_fundamental = mean(Total_fundamental))
data.frame(rbind(df1, df2)) %>%
select(Ano, Regiao, Rede, UF, Municipio, Total_medio,Total_infantil, Total_fundamental ) %>%
filter( Rede == 'Estadual' | Rede == 'Municipal'| Rede == 'Privada') %>%
replace(., is.na(.), 0.0) %>%
gather(variable, value, Total_medio:Total_infantil:Total_fundamental)
data.frame(rbind(df1, df2)) %>%
select(Ano, Regiao, Rede, UF, Municipio, Total_medio,Total_infantil, Total_fundamental ) %>%
filter( Rede == 'Estadual' | Rede == 'Municipal'| Rede == 'Privada') %>%
replace(., is.na(.), 0.0) %>%
gather(variable, value, Total_medio:Total_infantil:Total_fundamental) %>%head
data.frame(rbind(df1, df2)) %>%
select(Ano, Regiao, Rede, UF, Municipio, Total_medio,Total_infantil, Total_fundamental ) %>%
filter( Rede == 'Estadual' | Rede == 'Municipal'| Rede == 'Privada') %>%
replace(., is.na(.), 0.0) %>%
gather(variable, value, Total_medio:Total_infantil:Total_fundamental)
dfMedias <- data.frame(rbind(df1, df2)) %>%
select(Ano, Regiao, Rede, UF, Municipio, Total_medio,Total_infantil, Total_fundamental ) %>%
filter( Rede == 'Estadual' | Rede == 'Municipal'| Rede == 'Privada') %>%
replace(., is.na(.), 0.0) %>%
gather(variable, value, Total_medio:Total_infantil:Total_fundamental)
dfMedias <- data.frame(rbind(df1, df2)) %>%
select(Ano, Regiao, Rede, UF, Municipio, Total_medio,Total_infantil, Total_fundamental ) %>%
filter( Rede == 'Estadual' | Rede == 'Municipal'| Rede == 'Privada') %>%
replace(., is.na(.), 0.0) %>%
gather(ensino, value, Total_medio:Total_infantil:Total_fundamental) %>%
filter( value > 0)
# join regions and organize data
dfMedias <- data.frame(rbind(df1, df2)) %>%
select(Ano, Regiao, Rede, UF, Municipio, Total_medio,Total_infantil, Total_fundamental ) %>%
filter( Rede == 'Estadual' | Rede == 'Municipal'| Rede == 'Privada') %>%
replace(., is.na(.), 0.0) %>%
gather(ensino, value, Total_medio:Total_infantil:Total_fundamental) %>%
filter( value > 0) %>%
group_by(Ano, Regiao, Rede, UF, Municipio) %>%
summarise(value = mean(value))
# join regions and organize data
dfMedias <- data.frame(rbind(df1, df2)) %>%
select(Ano, Regiao, Rede, UF, Municipio, Total_medio,Total_infantil, Total_fundamental ) %>%
filter( Rede == 'Estadual' | Rede == 'Municipal'| Rede == 'Privada') %>%
replace(., is.na(.), 0.0) %>%
gather(ensino, value, Total_medio:Total_infantil:Total_fundamental) %>%
filter( value > 0) %>%
group_by(Ano, Regiao, Rede, UF, Municipio, ensino) %>%
summarise(value = mean(value))
dfMedias %>%
group_by(Regiao, ensino) %>%
summarise(value=mean(value))
##### Mean students per region #####
df_mean_all <- dfMedias %>%
group_by(Regiao, ensino) %>%
summarise(value=mean(value))
View(df_mean_all)
##### Mean students per region #####
df_mean_all <- dfMedias %>%
group_by(Regiao, ensino) %>%
summarise(value=mean(value))
ggplot(df_mean_all, aes(x = df_mean_all$Regiao, y = df_mean_all$value, fill = factor(df_mean_all$ensino))) +
geom_bar(stat = "identity", position=position_dodge()) +
labs(fill = "Ensino") +
xlab("Regiões do Brasil") + ylab("Média") +
ggtitle("Média de alunos por turma no ensino fundamental x médio x infantil no Brasil")
